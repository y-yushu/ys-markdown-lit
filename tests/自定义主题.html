<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>YsMdRendering - æµ‹è¯•å¯¹è±¡ç»‘å®š</title>
    <script type="module" src="../src/main.ts"></script>
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        width: 100%;
        overflow-x: hidden;
        box-sizing: border-box;
      }
      .page {
        margin: 0 auto;
        max-width: 1280px;
        padding: 1rem;
      }
      .grid {
        width: 100%;
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
      }
      .grid > div {
        max-width: 100%;
        border: 1px solid #ccc;
        padding: 1rem;
        border-radius: 8px;
        overflow-x: auto;
      }
      .test-section {
        margin: 1rem 0;
        padding: 1rem;
        border: 2px dashed #3b82f6;
        border-radius: 8px;
        background: #f0f9ff;
      }
      .test-section h4 {
        margin-top: 0;
        color: #1e40af;
      }
      .controls {
        margin: 1rem 0;
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
      }
      .controls button {
        padding: 0.5rem 1rem;
        border: 1px solid #3b82f6;
        background: white;
        color: #3b82f6;
        border-radius: 4px;
        cursor: pointer;
      }
      .controls button:hover {
        background: #3b82f6;
        color: white;
      }

      @media (prefers-color-scheme: dark) {
        body {
          background-color: #3c3c3c;
          color: white;
        }
        .grid > div {
          background-color: #2b2b2b;
          border: 1px solid rebeccapurple;
        }
        .test-section {
          background: #1e293b;
          border-color: #60a5fa;
        }
        .test-section h4 {
          color: #93c5fd;
        }
        .controls button {
          background: #1e293b;
          color: #93c5fd;
          border-color: #60a5fa;
        }
        .controls button:hover {
          background: #60a5fa;
          color: #1e293b;
        }
      }
    </style>
    <script type="module">
      import { MarkdownStr_table2 as mock } from '../src/mock.ts'

      // å®šä¹‰æµ‹è¯•ç”¨çš„æ ·å¼å¯¹è±¡
      const testStyles = {
        // è“è‰²ä¸»é¢˜
        blue: {
          h2: { color: 'blue', 'font-size': '1.5rem' },
          table: { color: 'red', border: '3px solid #00a497', 'border-radius': '8px' },
          th: { 'background-color': '#3b82f6', color: 'white', padding: '12px' },
          td: { padding: '10px', border: '1px solid #93c5fd' }
        },
        // çº¢è‰²ä¸»é¢˜
        red: {
          h2: { color: '#dc2626', 'font-size': '1.8rem', 'text-shadow': '2px 2px 4px rgba(0,0,0,0.1)' },
          table: { color: '#991b1b', border: '3px solid #dc2626', 'border-radius': '12px' },
          th: { 'background-color': '#dc2626', color: 'white', padding: '15px' },
          td: { padding: '12px', border: '1px solid #fca5a5' }
        },
        // ç»¿è‰²ä¸»é¢˜
        green: {
          h2: { color: '#059669', 'font-size': '1.6rem' },
          table: { color: '#047857', border: '3px solid #059669', 'border-radius': '10px' },
          th: { 'background-color': '#059669', color: 'white', padding: '14px' },
          td: { padding: '11px', border: '1px solid #a7f3d0' }
        }
      }

      window.onload = () => {
        // è·å–å…ƒç´ 
        const render1 = document.getElementById('render_1')
        const render2 = document.getElementById('render_2')
        const render3 = document.getElementById('render_3')
        const render4 = document.getElementById('render_4')

        // åˆå§‹å†…å®¹è®¾ç½®
        const sampleContent = `
## æµ‹è¯•æ ‡é¢˜
è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ®µè½ã€‚

| äº§å“åç§° | ä»·æ ¼ | çŠ¶æ€ |
|----------|------|------|
| iPhone 15 | Â¥6,999 | æœ‰åº“å­˜ |
| MacBook Pro | Â¥14,999 | ç¼ºè´§ |
| iPad Air | Â¥4,999 | æœ‰åº“å­˜ |
        `

        // è®¾ç½®åˆå§‹å†…å®¹
        if (render1) render1.content = sampleContent
        if (render2) render2.content = sampleContent
        if (render3) render3.content = sampleContent
        if (render4) render4.content = sampleContent

        // æµ‹è¯•1ï¼šæ¨¡æ‹Ÿ Vue çš„å¯¹è±¡ç»‘å®š
        console.log('ğŸ§ª æµ‹è¯•1ï¼šæ¨¡æ‹Ÿ Vue çš„å¯¹è±¡ç»‘å®šæ–¹å¼')
        if (render2) {
          // è¿™æ¨¡æ‹Ÿäº† Vue ä¸­ :custom-styles="proseStyles" çš„æ•ˆæœ
          render2.customStyles = testStyles.blue
          console.log('Vue å¯¹è±¡ç»‘å®šæˆåŠŸï¼Œåº”è¯¥æ˜¾ç¤ºè“è‰²ä¸»é¢˜')
        }

        // æµ‹è¯•2ï¼šæ¨¡æ‹Ÿ React çš„å±æ€§ç»‘å®š
        console.log('ğŸ§ª æµ‹è¯•2ï¼šæ¨¡æ‹Ÿ React çš„å±æ€§ç»‘å®šæ–¹å¼')
        if (render3) {
          // è¿™æ¨¡æ‹Ÿäº† React ä¸­ customStyles={proseStyles} çš„æ•ˆæœ
          render3.customStyles = testStyles.red
          console.log('React å±æ€§ç»‘å®šæˆåŠŸï¼Œåº”è¯¥æ˜¾ç¤ºçº¢è‰²ä¸»é¢˜')
        }

        // æŒ‰é’®äº‹ä»¶ï¼šåŸå§‹çš„å¢é‡æ›´æ–°åŠŸèƒ½
        const button = document.getElementById('test_but_1')
        if (button) {
          button.addEventListener('click', () => {
            console.log('å¼€å§‹å¢é‡æ›´æ–°å†…å®¹...')
            const renders = [render1, render2, render3, render4].filter(r => r)
            let index = 0
            const updateContent = () => {
              if (index < mock.length) {
                renders.forEach(render => {
                  if (render) render.content = mock.slice(0, index + 1)
                })
                index++
                setTimeout(updateContent, 10)
              }
            }
            updateContent()
          })
        }

        // ä¸»é¢˜åˆ‡æ¢æŒ‰é’®
        const blueBtn = document.getElementById('set-blue')
        const redBtn = document.getElementById('set-red')
        const greenBtn = document.getElementById('set-green')
        const clearBtn = document.getElementById('clear-styles')

        if (blueBtn) {
          blueBtn.addEventListener('click', () => {
            console.log('ğŸ¨ è®¾ç½®è“è‰²ä¸»é¢˜')
            if (render2) render2.customStyles = testStyles.blue
            if (render3) render3.customStyles = testStyles.blue
            if (render4) render4.customStyles = testStyles.blue
          })
        }

        if (redBtn) {
          redBtn.addEventListener('click', () => {
            console.log('ğŸ¨ è®¾ç½®çº¢è‰²ä¸»é¢˜')
            if (render2) render2.customStyles = testStyles.red
            if (render3) render3.customStyles = testStyles.red
            if (render4) render4.customStyles = testStyles.red
          })
        }

        if (greenBtn) {
          greenBtn.addEventListener('click', () => {
            console.log('ğŸ¨ è®¾ç½®ç»¿è‰²ä¸»é¢˜')
            if (render2) render2.customStyles = testStyles.green
            if (render3) render3.customStyles = testStyles.green
            if (render4) render4.customStyles = testStyles.green
          })
        }

        if (clearBtn) {
          clearBtn.addEventListener('click', () => {
            console.log('ğŸ§¹ æ¸…ç©ºæ‰€æœ‰æ ·å¼')
            if (render2) render2.customStyles = {}
            if (render3) render3.customStyles = {}
            if (render4) render4.customStyles = {}
          })
        }

        // æµ‹è¯•ä¸åŒçš„èµ‹å€¼æ–¹å¼
        const testDifferentAssignments = () => {
          console.log('ğŸ”¬ æµ‹è¯•ä¸åŒçš„èµ‹å€¼æ–¹å¼...')

          if (render4) {
            console.log('æµ‹è¯• JSON å­—ç¬¦ä¸²èµ‹å€¼')
            render4.customStyles = JSON.stringify(testStyles.green)

            setTimeout(() => {
              console.log('æµ‹è¯• null èµ‹å€¼')
              render4.customStyles = null
            }, 2000)

            setTimeout(() => {
              console.log('æµ‹è¯•ç©ºå¯¹è±¡èµ‹å€¼')
              render4.customStyles = {}
            }, 4000)

            setTimeout(() => {
              console.log('æµ‹è¯•æ— æ•ˆ JSON å­—ç¬¦ä¸²')
              render4.customStyles = 'invalid json'
            }, 6000)

            setTimeout(() => {
              console.log('æµ‹è¯•æ•°ç»„èµ‹å€¼ï¼ˆåº”è¯¥è¢«è½¬æ¢ä¸ºç©ºå¯¹è±¡ï¼‰')
              render4.customStyles = [1, 2, 3]
            }, 8000)

            setTimeout(() => {
              console.log('æœ€ç»ˆæµ‹è¯•ï¼šæ¢å¤æ­£å¸¸å¯¹è±¡')
              render4.customStyles = testStyles.blue
            }, 10000)
          }
        }

        // é«˜çº§æµ‹è¯•æŒ‰é’®
        const advancedTestBtn = document.getElementById('advanced-test')
        if (advancedTestBtn) {
          advancedTestBtn.addEventListener('click', testDifferentAssignments)
        }

        // åŠ¨æ€æ›´æ–°æµ‹è¯•
        const dynamicTestBtn = document.getElementById('dynamic-test')
        if (dynamicTestBtn) {
          dynamicTestBtn.addEventListener('click', () => {
            console.log('ğŸ”„ å¼€å§‹åŠ¨æ€æ›´æ–°æµ‹è¯•')
            let counter = 0
            const themes = ['blue', 'red', 'green']

            const updateTheme = () => {
              const theme = themes[counter % themes.length]
              console.log(`åˆ‡æ¢åˆ°${theme}ä¸»é¢˜`)

              if (render2) render2.customStyles = testStyles[theme]
              if (render3) render3.customStyles = testStyles[theme]

              counter++
              if (counter < 10) {
                // å¾ªç¯10æ¬¡
                setTimeout(updateTheme, 1000)
              }
            }
            updateTheme()
          })
        }

        // ç›‘å¬äº‹ä»¶ï¼ˆä¿ç•™åŸæœ‰åŠŸèƒ½ï¼‰
        const codedom = document.getElementById('c056')
        if (codedom) {
          codedom.addEventListener('copy-text', e => {
            console.log('e.detail.text', e?.detail?.text)
          })
        }

        console.log('âœ… é¡µé¢åˆå§‹åŒ–å®Œæˆï¼Œæ‰€æœ‰æµ‹è¯•å·²è®¾ç½®')
        console.log('ğŸ’¡ æŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºæ¥è§‚å¯Ÿæµ‹è¯•ç»“æœ')
        console.log('ğŸ¯ å¦‚æœå¯¹è±¡ç»‘å®šç”Ÿæ•ˆï¼Œrender_2 åº”è¯¥æ˜¾ç¤ºè“è‰²ä¸»é¢˜ï¼Œrender_3 åº”è¯¥æ˜¾ç¤ºçº¢è‰²ä¸»é¢˜')
      }
    </script>
  </head>

  <body>
    <div class="page">
      <div class="test-section">
        <h4>ğŸ§ª ObjectConverter å…¼å®¹æ€§æµ‹è¯•</h4>
        <p>è¿™ä¸ªé¡µé¢æµ‹è¯•äº† ObjectConverter æ˜¯å¦èƒ½æ­£ç¡®å¤„ç† Vue å’Œ React é£æ ¼çš„å¯¹è±¡ç»‘å®š</p>

        <div class="controls">
          <button id="test_but_1">å¼€å§‹å†…å®¹æ›´æ–°</button>
          <button id="set-blue">è®¾ç½®è“è‰²ä¸»é¢˜</button>
          <button id="set-red">è®¾ç½®çº¢è‰²ä¸»é¢˜</button>
          <button id="set-green">è®¾ç½®ç»¿è‰²ä¸»é¢˜</button>
          <button id="clear-styles">æ¸…ç©ºæ ·å¼</button>
          <button id="advanced-test">é«˜çº§å…¼å®¹æ€§æµ‹è¯•</button>
          <button id="dynamic-test">åŠ¨æ€åˆ‡æ¢æµ‹è¯•</button>
        </div>
      </div>

      <div class="grid">
        <div>
          <h3>åŸå§‹æ–¹å¼ - JSON å­—ç¬¦ä¸²ç»‘å®š</h3>
          <p><code>custom-styles='{"h2":{"color":"blue"}}'</code></p>
          <div>
            <ys-md-rendering id="render_1" custom-styles='{"h2":{"color":"blue"},"table":{"color":"red","border":"3px solid #00a497"}}'> </ys-md-rendering>
          </div>
        </div>

        <div>
          <h3>Vue é£æ ¼ - å¯¹è±¡ç»‘å®šæµ‹è¯•</h3>
          <p><code>element.customStyles = objectValue</code></p>
          <div>
            <ys-md-rendering id="render_2"> </ys-md-rendering>
          </div>
        </div>

        <div>
          <h3>React é£æ ¼ - å±æ€§ç»‘å®šæµ‹è¯•</h3>
          <p><code>customStyles={proseStyles}</code></p>
          <div>
            <ys-md-rendering id="render_3"> </ys-md-rendering>
          </div>
        </div>

        <div>
          <h3>å…¼å®¹æ€§å‹åŠ›æµ‹è¯•</h3>
          <p>æµ‹è¯•å„ç§è¾¹ç•Œæƒ…å†µå’Œé”™è¯¯è¾“å…¥</p>
          <div>
            <ys-md-rendering id="render_4"> </ys-md-rendering>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
